---
layout: post
title: "Making your password TextBox more secure"
---

<p>If you use a Windows Forms <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.aspx"><var>TextBox</var></a> to let your users enter a password, you should know itâ€™s not very secure: external applications can get the password from the <var>TextBox</var> by sending it the <a href="http://msdn.microsoft.com/en-us/library/ms632627.aspx"><var>WM_GETTEXT</var></a> message. There are even applications written specifically to do this. If you want to prevent this, you can use the following control that is derived from <var>System.Windows.Forms.TextBox</var> and that prevents external applications from getting the password via <var>WM_GETTEXT</var>. Just use it instead of the regular <var>TextBox</var> for password fields.</p>

<script src="https://gist.github.com/2161891.js?file=SafeWinFormsPasswordTextBox.cs"></script>
<noscript><p><a href="https://gist.github.com/2161891">SafeWinFormsPasswordTextBox.cs</a></noscript>

<p><small><b>EDIT</b>: I added code to also ignore <a href="http://msdn.microsoft.com/en-us/library/bb761653.aspx"><var>EM_SETPASSWORDCHAR</var></a> which can also be used to make the password visible.<br>
<b>EDIT 2</b> (2008-04-22): I fixed the documentation tags in the code.<br>
<b>EDIT 3</b> (2008-04-22): I fixed some bugs that denied access to the password from within your program.</small>